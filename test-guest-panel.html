<!DOCTYPE html>
<html>
<head>
    <title>Guest Panel Test</title>
    <style>
        .guests-group {
            position: relative;
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px;
            width: 200px;
        }
        
        .guests-display {
            font-size: 14px;
            font-weight: 600;
            color: #333 !important;
            cursor: pointer;
            user-select: none;
            line-height: 1.2;
            text-decoration: none !important;
        }
        
        .guest-details {
            font-size: 12px;
            color: #666 !important;
            font-weight: normal;
            margin-top: 1px;
            line-height: 1.1;
        }
        
        .guests-inputs {
            position: absolute;
            top: calc(100% + 8px);
            left: -15px;
            right: -15px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            z-index: 1000;
            min-width: 280px;
            display: none;
        }
        
        .guests-inputs.show {
            display: block !important;
        }
        
        .guest-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 8px 0;
        }
    </style>
</head>
<body>
    <h1>Guest Panel Test</h1>
    
    <div class="guests-group">
        <div class="guests-selector">
            <div class="guests-display" onclick="toggleGuestPanel(event)">
                <span class="room-count">1</span> Room, 
                <span class="guest-count">2</span> Guests
                <div class="guest-details">2 Adults</div>
            </div>
            <div class="guests-inputs" id="guest-panel">
                <div class="guest-row">
                    <label>Rooms:</label>
                    <select id="rooms" name="rooms" onchange="updateGuestsDisplay()" onclick="event.stopPropagation()">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                    </select>
                </div>
                <div class="guest-row">
                    <label>Adults:</label>
                    <select id="adults" name="adults" onchange="updateGuestsDisplay()" onclick="event.stopPropagation()">
                        <option value="1">1</option>
                        <option value="2" selected>2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </div>
                <div class="guest-row">
                    <label>Children:</label>
                    <select id="children" name="children" onchange="updateGuestsDisplay()" onclick="event.stopPropagation()">
                        <option value="0" selected>0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        function toggleGuestPanel(event) {
            if (event) {
                event.stopPropagation();
            }
            
            console.log('toggleGuestPanel called');
            
            var panel = document.getElementById('guest-panel');
            if (!panel) {
                console.error('Guest panel not found');
                return;
            }
            
            var isVisible = panel.classList.contains('show');
            
            if (isVisible) {
                panel.classList.remove('show');
                console.log('Panel hidden');
            } else {
                panel.classList.add('show');
                console.log('Panel shown');
            }
        }

        function updateGuestsDisplay() {
            console.log('updateGuestsDisplay called');
            
            var roomsSelect = document.getElementById('rooms');
            var adultsSelect = document.getElementById('adults');
            var childrenSelect = document.getElementById('children');
            
            if (!roomsSelect || !adultsSelect || !childrenSelect) {
                console.error('One or more select elements not found');
                return;
            }
            
            var rooms = roomsSelect.value || 1;
            var adults = adultsSelect.value || 2;
            var children = childrenSelect.value || 0;
            
            console.log('Values:', { rooms, adults, children });
            
            var guestTotal = parseInt(adults) + parseInt(children);
            
            var roomCountElement = document.querySelector('.room-count');
            var guestCountElement = document.querySelector('.guest-count');
            var guestDetailsElement = document.querySelector('.guest-details');
            
            if (roomCountElement) roomCountElement.textContent = rooms;
            if (guestCountElement) guestCountElement.textContent = guestTotal;
            
            var detailText = adults + ' Adult' + (adults > 1 ? 's' : '');
            if (children > 0) {
                detailText += ', ' + children + ' Child' + (children > 1 ? 'ren' : '');
            }
            
            if (guestDetailsElement) {
                guestDetailsElement.textContent = detailText;
            }
            
            console.log('Display updated:', detailText);
        }

        // Close guest panel when clicking outside
        document.addEventListener('click', function(event) {
            var guestPanel = document.getElementById('guest-panel');
            var guestGroup = document.querySelector('.guests-group');
            
            if (guestPanel && guestGroup && !guestGroup.contains(event.target)) {
                guestPanel.classList.remove('show');
            }
        });

        // Prevent panel from closing when clicking inside
        document.addEventListener('DOMContentLoaded', function() {
            var guestPanel = document.getElementById('guest-panel');
            if (guestPanel) {
                guestPanel.addEventListener('click', function(event) {
                    event.stopPropagation();
                });
            }
            
            // Initialize guest display
            updateGuestsDisplay();
        });
    </script>
</body>
</html>